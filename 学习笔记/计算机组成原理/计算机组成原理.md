# 计算机组成原理

## 课程概貌

讲授内容

基本不见的结构和组织方式

基本运算的操作系统

基本部件和单元的设计思想

### 课程的分割整合

计算机组成原理之机器

1. 计算机系统的基本概念
2. 总线
3. 存储器
4. 输入输出系统

计算机组成原理至数字

1. 计算机中数的表示
2. 计算机的运算方法和运算器

计算机的组成原理之cpu

1. 指令系统
2. cpu的结构和功能
3. 控制单元
4. 控制单元的设计

### 指令的引入是，分析加测评

## 第一章　概论

### 计算机系统简介

现代计算机系统的多态性

#### 1，计算机系统

  硬件： 计算机的实体，如主机，外设

  软件：由具有各类型特殊功能的信息组成

> 系统软件 用来管理整个计算机系统
>
> ​                   语言处理程序
>
> ​                   操作系统
>
> ​                   服务型程序
>
> ​                    数据库管理系统
>
> ​                     网络软件

> 应用软件      按任务需要编制成的各种程序

#### 2，计算机系统的层次结构

系统复杂性管理的方法1

抽象-指高级的模型，和低级的实体相对

​         隐藏系统中不必要的细节





高级语言

汇编语言 

操作系统

机器语言 

微指令系统

程序员角度：

虚拟机器m4       用程序翻译成汇编语言

|

虚拟机器m3       翻译成机器语言

|

虚拟机器m2       用机器语言解释成操作系统         软件

|                                                                                    |

实际机器m1       用微指令解释机器指令                  硬件

|

微程序机器m0     有硬件直接执行微指令

计算机体系结构：程序员所见到的计算机系统属性

​                               概念性结构与功能特性

计算机组成：实现计算机体系结构所体现的属性

​                       （具体指令的实现）



### 计算机的基本结构

1，冯诺依曼计算机特点

edvac（缩写）

1. 控制器-运算器-存储器-输出设备-出入设备
2. 指令和数据以同等地位存于存储器，可按地址寻访
3. 指令和数据用二进制表示
4. 指令由操作码和地址码组成
5. 存储器
6. 以运算器为中心

2，计算机硬件框图

1. 以存储器位中心的计算机硬件框图

2. 现在计算机硬件框图

   运算器   alu       cpu

   控制器     cu       cpu       主机            

   存储器      主存                 主机            硬件

   ​                   辅存

   输入设备          i/0设备       i/o              硬件  

   输出设备          i/o设备

* 系统复杂性管理的方法

   -层次化：将被设计的系统划分为多个模块或子模块

   -模块化：有明确定义的功能和接口

   -规则化：模块更加容易被重用



计算机解决的问题：

一个现实的问题，如何利用计算机来解决？

1. 上机前准备
   * 建立数学模型
   * 确定计算方法
   * 编制解题程序



​         指令分为操作码和地址码

​         数据也保存在存储器中

​         1。存储器的基本组成

​                存储体-存储单元-存储元件

​                存储单元：存放一串二进制代码

​                存储字：存储单元中二进制代码的组合

​                存储长度：存储单元中二进制代码的数，每个存储单元赋予了一个地址

​                按地址寻访

​                 存储器的基本组成

​                            mar存储器地址寄存器反映存储单元的个数

​                             mdr存储器数据寄存器反映存储字长

​            2。运算器的结构？x alu acc mq

​           3。控制器的结构如何呢？

​                   功能：解释指令，保证指令的按序执行

​                    完成一条指令: 取指令pc，分析指令ir，执行指令cu

​                指令：取数指令，存数指令

​             5。ax^2+bx+c程序的运行过程

​                  将程序通过输入设备送至计算机

​                  程序首地址-》pc

​                  启动程序运行

​                  取地址pc-mar-m-mdr-ir，（pc）+1-  pc

​                  分析指令  op（ir）-cu

​                  执行指令  ad（ir）-mar-m-mdr-acc

​                   。。。

​                   打印结果

​                   停机

### 计算机硬件的主要技术指标

1. 机器字长
2. 运算速度   （主频，核数，吉布森法 cpi 执行一条指令需要的时钟周期，mips 每秒执行的命令多少，每秒完成了多少浮点运算）
3. 存储容量（主存容量<存储单元个数×存储字长，字节数>，辅存容量）

## 第二章　计算机发展史

### 2.1计算机发展史

1. 计算机的产生 第一太计算器neinc

   计算机的驱动力：需求，技术发展，

   1代 电子管，二晶体管，三中小规模集成电路，四，大规模集成电路， 5超大规模集成短路

2. 微型计算机的出现和发展

3. 软件技术的兴起和发展

    1各种语言

   ​     机器语言 面向机器

   ​     汇编语言 面向机器

   ​     高级语言 面向问题

   2 系统软件

   ​    语言处理程序， 汇编程序，编译程序，解释程序

   ​    操作系统，

   ​    服务性程序

   ​    数据库管理系统

   ​    网络软件

   3 软件发展特点

      （1）开发周期长
    
      （2）制作成本高昂
    
      （3）检测软件产品质量的特殊性

​              软件是程序以及开发，使用，和维护程序所需要的所有文档

### 2.2计算机的应用

一，科学计算和数据处理

二，工业控制和实时控制

三，网络技术

​        1，电子商务

​        2，网络教育

​        3，敏捷制造

四，虚拟现实

​          1.飞行训练机

五，办公自动化和管理信息系统

六，cad/cam/cims

七，多媒体技术

八，人工智能

### 2.3计算机的展望

一，计算机具有类似人脑的一些超级智能功能

二，芯片集成度的提高限制

​      芯片集成度受物理极限制约

​      按集合结束递增的制作成本

​      芯片的功耗，散热，线延迟

三 ？替代传统的硅芯片

​          1，光计算机

​                 利用光子取代电子进行运算和存储

​          2，DNA生物计算

​                通过控制DNA分子间的生化反应

​          3，量子计算机

​                利用原子所具有的量子特性

## 第三章 系统总线

#### 3.1总线的基本分类

一，为啥要用总线

二，什么是总线

　　　　总线是链接各个部件的信息传输线

　　　　是各个部件共享的传输介质

三，总线上信息的传送

　　　　串行

　　　　并行

四，总线结构的计算机举例

　　　１，单总线结构框图

　　　２，面向ｃｐｕ的双总线结构框图

　　　３，以存储器为中心的双总线结构框图



#### 3.2总线的分类

１，片内总线，　芯片内部的总线

２，系统总线　计算机各个部件之间的信息传输总线

　　数据总线　双向与机器字长，存储器字长有关

　　地址总线　单向　与存储器地址，ｉ/o地址有关

　　控制总线　　有出（存储器的读，写）　　有入（中断）

３，通信总线

　　用于计算机系统之间或计算机系统与其他系统（如控制仪表，移动通信等）之间的通信

　　　　　　　　｜串行通信总线

　　传输方式　　｜并行通信总线

#### 3.3总线特性及性能指标

一，总线物理实现

二，总线特性

　　１，机械特性　尺寸，形状，管脚数　排列顺序

　　２，电气特性　传输方向和有效的电平范围

　　３，功能特性　每根传输线的功能（地址，数据，控制）

　　４，时间特性　信号的时序关系

三，总线的性能指标

　　１总线的宽度

　　２，标准传输率

　　３，时钟同步，异步

　　４，总线服用　地址线与数据线服用（减少管脚数）

　　５，信号线数　地址，数据，控制，总和

　　６，总线控制方式　突发，自动，仲裁，逻辑，计数

　　７，其他指标

四，总线标准

　　模块　标准界面

　　系统　　　

#### 3.4总线结构

一，单总线结构

二，多总线结构

　　１，双总线结构

　　２，三总线结构　ｉ/o总线　主存总线　ｄｍａ总线

　　３，三总线结构又一形式　局部总线，系统总线，扩展总线

　　４，四总线结构　局部总线，系统总线，告诉总线，扩展总线

三，总线结构举例

　　１，传统微型机总线结构

　　２，ＶＬ－ＢＵＳ局部总线结构

　　３，ＰＣＩ总线结构

　　４，多层ＰＣＩ总线结构

#### 3.5总线控制

一，总线的判优控制

　　１，基本概念

　　　　主模块　对总线有控制权

　　　　从模块　响应从主设备发来的总线命令

　　　　　　　　　　　　　　　　　｜链式查询

　　　　　　　　　　　｜集中式　　｜计数器定时查询

　　　　　　　　　　　　　　　　　｜独立请求方式

　　　　总线判优控制　｜分布式

　　２，链式查询

　　　　ＢＳ－总先忙

　　　　ＢＲ－总线请求

　　　　ＢＧ—总线允许

　　３，计数器定时查询

　　　　ＢＳ－同上

　　　　ＢＲ－同上

　　３，独立请求方式

　　　　ＢＧ

　　　　ＢＲ

二，总线通信控制

　　１，目的　解决通信双方　协调配合

　　２，总线传输周期

　　　　申请分配阶段　主模块申请，总线仲裁决定

　　　　寻址　　　　　主模块向从模块给出地址　和命令

　　　　传数阶段　　　主模块和从模块交换数据

　　　　结束阶段　　　主模块撤销有关消息

　　３，总线通信的四种方式

　　　　同步通信　由统一时标控制数据传输

　　　　异步通信　采用应答方式，没有公共时钟标准

　　　　半同步通信　同步，异步结合

　　　　分离式通信　充分挖掘　系统　总线每个瞬间的潜能

　　　　（１）同步式数据输入，固定时间点给出相应操作

　　　　（２）同步式数据输出　固定的时间给出固定的操作

　　　　　　　　用最慢的时间标识，来作为标识

　　　　（３）异步通信　　请求　回答

　　　　　　　　　不互锁，　半互锁　　全互锁

　　　　（４）半同步通信（同步，异步结合）

　　　　　　　同步　发送方用系统　时钟前沿发信号

　　　　　　　　　　接受方用系统时钟后沿判断，识别

　　　　　　　异步　允许不同速度的模块和谐工作

　　　　　　　　　　增加一天“等待”相应信号

　　　　　　以输入数据为例的半同步通信时序

　　　　　　　Ｔ１，主模块发地址

　　　　　　　Ｔ２，主模块发命令

　　　　　　　Ｔｗ　当ｗａｉｔ为低电平时，等待一个ｔ

　　　　　　　。。

　　　　　　　Ｔ３　从模块提供数据

　　　　　　　Ｔ４　从模块撤销数据，主模块撤销命令

　　　　　（４）半同步信号（同步，异步结合）

　　　以上三种通信的共同特点

　　　　　一个总线传输周期（以输入数据位例）

　　　　　主模块发地址，命令　占用总线

　　　　　从地址准备数据　　不占用总线　总线空闲

　　　　　从模块向主模块发数据　占用总线

　　　　　（５）分离式通信　

　　　　　　　　充分挖掘总线每个瞬间的潜力

　　　　　　　　一个中线传输周期

　　　　　　　　｜子周期１　主模块申请　占用总线，使用完成

　　　　　　　　　　　　　　后放即放弃中线的使用权

　　　　　　　　｜子周期２　从模块申请占用总线，将各种信号送

　　　　　　　　　　　　　　至总线上

　　　　　　　　分离式通信特点：

　　　　　　　　　　　　１．各模块有权申请占用总线

　　　　　　　　　　　　２．采用同步方式通信，不等对方回答

　　　　　　　　　　　　３．各模块准备数据时，不占用总线

　　　　　　　　　　　　４．总线被占用时，无空闲

## 第四章　存储器

#### 4.1，概述　　

　　存储器类型？

​       现代存储器的层次结构，为什么要分层？

一，存储器的分类

　　１，按存储器介质分类

　　　　（１）半导体，　　TTL，MOS　　　　　　易失

　　　　（２）磁表面存储器 磁头，载磁体　　　　　非易失

　　　　（３）磁芯存储器　硬磁材料　环状原件　　非易失

　　　　（４）光盘存储器　激光，磁光材料　　　　非易失

　　２，按存取方式分类

　　　（１）存取时间与物理地址无关（随机访问）

　　　　　　　随机存储器　在程序执行过程中可读可写

　　　　　　　只读存储器　在程序的执行过程中　只读

　　　（２）存取时间与物理地址有关（串行访问）

　　　　　　　顺序存储器　　　磁带

　　　　　　　直接存取存储器　磁盘

　　３，按在计算机中的作用分类

　　　　　　　　　　　　　　　　静态ＲＡＭ
　　　　　　　　　　　　　RAM　动态ＲＡＭ

​                            主存储器　　

　　　　　　　　　　　　　　　　MROM
　　　　　　　　　　　　　　　　ＰROM

　　　　　　　　　　　　　ROM   EPROM

​                                                             EEPROM

　　　　存储器 Flash Memory

　　　　　　　高速缓存存储器（ｃａｓｈｅ）

​                            辅助存储器（磁盘，磁带，光盘）

二，存储器的层次结构

　　１，存储器的主要特性的关系

　　　　　速度　容量，价格/位

​              (存储体系)

　　　　寄存器，缓存，主存，磁盘，光盘，磁带

　　　　（软件硬件相结合，程序员不用关心存储在哪）

　　２，存储－主存层次和主存－辅存层次

　　　　缓存－主存（硬件）　主存－辅存（软硬件结合）　

　　　

#### 4.2，主存储器

一，概述

　１，基本组成

　２，主存和ｃｐｕ关系（总线相连）

　３，主存中存储单元地址分配

　　　高位字节地址位字地址

　　　低位字节地址为字地址

　４，主存的技术指标

　　　（１）存储容量　主存　存放二进制代码总位数

　　　（２）存储速度

　　　　　　　存取时间　存储器的访问时间　读取时间　写入时间

　　　　　　　存取周期　连续两次独立的存储器操作（读或写）所需的最小间隔时间

　　　　　　　　　　　　读周期　写周期

　　　（３）存储带宽

二，半导体芯片简介

１，半导体存储结构

　　地址线，片选线，读写控制线，数据线

２，半导体存储芯片的译码驱动方式

　　（１）线选法

　　　　　　地址译码器，　读写控制电路

　　（２）重合法

　　　　　　ｘ地址译码器，ｙ地址译码器，　读写控制

三，随机存取存储器（ｒａｍ）

　　１，静态ｒａｍ

　　　　保存０和１的原理是什么？

　　　　　开关，熔丝？

　　　　　用的是触发器？（４个管子）

　　　　基本单元电路的构成？

　　　　对单元电路如何读出和写入？

　　　　典型芯片的结构是什么样子的？

　　　　静态ｒａｍ芯片的如何进行读出和写入操作？

　　２，动态ＲＡＭ

　　３，动态RＡＭ和静态ＲＡＭ的比较

四，只读存储器（ｒｏｍ）

　　保存系统程序和系统的配置信息

　　　> 最早的只读存储器－－在厂家就写好了内容
　　　>
　　　> 改进１－－用户可以自己写－一次性
　　　>
　　　> 改进２－－可以多次写－－要能对信息进行擦除
　　　>
　　　> 改进３－－电可擦写－－特定设备
　　　>
　　　> 改进４－－电可擦写－－直接链接到计算机

１，掩模ＲＯＭ

​     　行列选择线交叉处有MOS管为“１“

　　行列选择线交叉处无ＭＯＳ管位”０“

２，ＰＲＯＭ（一次性编程）

３，ＥＰＲＯＭ（多次性编程）（紫外线可擦除）

４，EEＰＲＯＭ（多次性编程）

　　电可擦写，局部可擦写，全部可擦写

５，Ｆｌａｓｈ　Ｍｅｍｏｒｙ（闪速型存储器）

　　ＥＰＥＯＭ　　　价格便宜　集成度高

　 　ＥＥＰＲＯＭ　电可擦洗重写	

　　比ＲＲＰＲＯＭ快　具备ＲＭＡ功能

五，存储器与ｃｐｕ的链接

１，存储器容量的扩展

　　（１）位扩展（增加存储字长）（并联）（把一个芯片当一个来用）

　　（２）字扩张（增加容量）（串联）（增加一个片选）

　　（３）字，位扩展

２，内存和ｃｕｐ的链接

　　（１）地址线的链接

　　（２）数据线的链接

　　（３）控制线读/写的链接

　　（４）片选线的链接

　　（５）合理的选择存储芯片

　　（６）其他　　时序　负载

例题：（１）写出对应的二进制地址码

　　　（２）确定芯片的数量以及类型

　　　（３）分配地址线

　　　（４）确定片选信号

六，存储器的校验

​	１，为什么要对存储器的信息进行校验

　　２，为了能够校验出信息是否正确，如何进行编码

　　３，纠错或检错能力与生么有关

　　４，校验出信息出错后是如何进行纠错的

　　５，除了我们教材将的校验码，你还知道那些容错编码，原理是生么



合法代码集合

　　１，｛０００，００１，，，，１１１｝检０位错，纠０位错

　　２，｛０００，０１１，１０１，１１０｝检１位错，纠０位错

　　３，｛０００，１１１｝检１位错，纠１位错

　　４，｛００００，１１１１｝检２位错，纠１位错

　　５，｛０００００，１１１１１｝检２位错，纠２位错

　　编码的检测能力和纠错能力和什么有关？

　　任意两个合法代码之间二进制位的最小差异数

１，编码的最小距离

　　　任意两组合法代码之间二进制位数的最小差异编码的纠错，检错能力与编码的最小距离

　　L-1-=D+C(D>=C)

　　Ｌ－－编码的最小距离　L=3

　　Ｄ－－检测错误的位数　具有一位纠错能力

　　Ｃ－－纠正错误的位数

２，汗明码的组成

　　汉明码采用奇偶检验

　　汉明码采用分组校验

　　汉明码的分组是一种非划分方式

　　分成３组，每组有１位校验位，工包括４位数据位

　　组成汉明码的三要素

　　哈明码的组成需增添？位检测位

　　检测位的位置

　　检测位的取值

　　　检测为的取值与该位所在的检测”小组“承担的奇偶校验任务有关

例题：求０１０１按偶校验配置汉明码

　　　ｎ＝４

　　　　２^K>=n + k + 1

​                    k=3

汉明码排序如下：

二进制序号：　１　２　３　４　５　６　７

名称　　　　　ｃ１ｃ２０　ｃ４１　０　１

　　　　　　　０　１　　　　０

３，汉明码的纠错过程

０１００１１１

ｐ１＝１亦或３　　５　　７＝０　无错

ｐ２＝２　　３　　６　　７＝１　有错

ｐ４＝４　　５　　６　　７＝１　有错

第六位错了

校验位错了可以不用纠错

七，提高存取速度的措施

采用高速器件

采用层次结构ｃａｃｈｅ—主存

调整主存结构

１，单体多字系统

增加存储器的带宽

２，多体并行系统

（１）高位交叉，顺序编址

（２）地位交叉　各个题轮流编址

低位交叉的特点（ｃｕｐ速度大于内存的，所以可以在一个周期内给多个存储器发送命令）

　　不改变存取周期的前提下，增加存储器的带宽

３，高性能存储芯片

　（１）SDRAM(同步ＤＲＡＭ)

　　　在系统时钟的控制下进行读出和写入

　　　ｃｐｕ无须等待

　（２）ＲＤＲＡＭ

　　　　主要解决存储器带宽问题

　（３）带ＣＡＣＨＥ的DRＡＭ

　　　在ＤＲＡＭ的芯片内集成了一个由ＳＲＡＭ组成的ｃａｃｈｅ，有利用猝发式读取

#### 4.3，高速缓存存储器

* 一概述

  １，为什么用ｃａｃｈｅ

  　　避免ｃｐｕ“空等”现象

  　　ｃｐｕ个主存（ｄｒａｍ）的速度差异

  　　程序局部性访问原理

  ２，ｃａｃｈｅ的工作原理

  　　主存和缓存的编址（主存和缓存按块存储，块的大小相同）

  

  　　命中与未命中

  　　　主存大于缓存，

  　　　主存块与缓存块建立了对应关系

  　　　用标记记录与某缓存块建立了对应关系的主存块号

  　　　未命中　主存块　未调入

  　　　　　　　主存快与缓存块　未建立　对应关系

  

  　　ｃａｃｈｅ的命中率

  　　　ｃｐｕ欲访问的信息字ｃａｃｈｅ中的比率

  　　　命中率与ｃｈｃｈｅ的容量与块长有关

  　　　块长取一个存取周期内从主存调出信息的长度

  

  　　ｃａｃｈｅ主存系统的效率

  　　　ｅ=访问ｃａｈｃｈｅ的时间/平均访问时间　×１００％

  ３，ｃａｃｈｅ的基本结构

  　　主存的替换和映射　,cache存储体，

  

  ４，ｃａｃｈｅ的读写操作

  　　读　ｘｘ

  　　写　ｃａｃｈｅ和主存的一致性

  　　　　写直达法（即写ｃａｃｈｅ又写内存）

  　　　　写回法(写ｃａｃｈｅ)

  

  ５，ｃａｃｈｅ的改进

　　　　增加ｃａｃｈｅ的级数

　　　　　　片内ｃａｃｈｅ

　　　　　　片外ｃａｃｈｅ

　　　　统一缓存和分立缓存

　　　　　　指令ｃａｃｈｅ　数据ｃａｃｈｅ

* 二，cache 主存的地址映射

　　　１，直接映射（主存块和ｃａｃｈｅ块大小相同）

　　　　　每个缓存块可以和若干个主存块对应

　　　　　每个主存块智能和一个缓存块对应

　　　２，全相联模式（任何一个主存块可被映射到任意一个擦车

中）　　　问题：需要查看每个标记块

　　　３，组相连映射（ｃａｃｈｅ被分成若干组，每组ｃａｃｈｅ内块可以放置内存组中的任意块）

　　　　结构较位简单，不复杂，速度快

* 三，替换算法

　　　１，先进先出（FILO）算法

　　　２，近期使用最少算法（ＬＲＵ）算法

#### 4.4，辅助存储器

* 一，概述

  　　１，特点，不直接与ｃｐｕ交换信息

  　　２，磁表面存储技术指标

  　　　　１，记录密度　２，存储容量　３，平均寻址时间，　４数据传输率　５，误码率

* 二，磁记录原理

  　　写：读：

* 三，硬盘存储器

　　　　１，硬磁盘存储器类型

　　　　　　（１）固定磁头和移动磁头

　　　　　　（２）可换盘和固定盘

　　　　２，硬磁盘存储器结构

　　　　３，磁盘控制器

　　　　　　接收主机发来的命令，转换成磁盘驱动器的控制命令

　　　　　　实现格式转换，控制磁盘的读写，

　　　　４，盘片　铝合金

* 四，软盘存储器
* 五，光盘存储器

　　　　采用光存储技术　利用激光写入和读出

　　　　第一代不可擦写

　　　　第二带不可擦写

##　第五章　输入输出系统

###　5.1，概述

一，输入输出系统的发展

　　１，早起

　　　　分散链接

　　　　ｃｐｕ和ｉ/o设备　串行工作　程序查询方式

　　２，借口模块和ｄｍａ阶段

　　　　总线链接　　　　　　　　　　｜终端方式

　　　　ｃｐｕ和ｉ/ｏ设备　并行工作　｜ｄｍａ方式

　　３，具有通道结构的阶段

　　４，具有ｉ/o处理机的阶段

二，输入输出系统的组成

　　１，ｉ/ｏ软件

　　　　（１）ｉ/o指令　ｃｐｕ指令的一部分

　　　　　　　　　操作码　命令码　设备码

　　　　（２）通道指令　通道自身的指令

　　　　　　　指出数组的首地址，传送字数，操作命令

　　　　　　　如ｉｂｍ/３７０通道指令为６４位

　　２，硬件

　　　　设备　　i/o接口

　　　　设备　　设备控制器　　通道

三，ｉ/o设备与主机的联系方式

　　１．ｉ/o设备编制方式

　　　（１）统一编址　取数，存数指令	

　　　（２）不统一编址　有专门的i/o指令

　　２，设备选址

　　　　用设备选择电路识别是否被选中

　　３，传送方式

　　　　１，串行

　　　　２，并行

　　４，联络方式

　　　　１，立即响应

　　　　２，异步工作采用应答信号

　　并行：

　　串行：

　　　　３，同步工作采用同步时标

　　５，i/o设备与主机的链接方式

　　　　１，辐射式链接

　　　　２，总线链接

四，i/o设备与主机信息传送的控制方式

　　１，程序查询方式

　　　　ｃｐｕ一手拖两家，ｃｐｕ原地踏步等待设备接入



　　２，程序中断方式

　　　　　　　　　　｜自身准备　　　　ｃpu不查询

　　　　i/o设备工作　｜与主机交换信息　ｃｐｕ暂停现行程序

　　　　没哟踏步等待现象，中断现行程序

　　　　ｃｐｕ和ｉ/o部分的并行工作

　　　　需要ｃｐｕ保护现场



　　３，ｄｍａ方式

　　　　主存和i/o之间有一条数据通道

　　　　不中断现行程序

　　　　周期挪用（周期窃取）

　　　　ｃｐｕ和ｉ/o并行工作

### 5.2，外部设备

一，概述

　设备控制器，机，电，磁，光

　外部设备大致分为三类

　１，人机交互设备　　键盘，鼠标，打印机，显示器

　２，计算机信息存储设备　磁盘，光盘，磁带

　２，机－机通信设备　调制解调器等

二，输入设备

　　１，键盘

　　　　按键

　　　　判断那个键按下

　　　　将此键翻译成ａｓｃＩＩ码（编码键盘法）

　　　　方式：中断方式

　　２，鼠标

　　　　机械式　金属球　电位器

　　　　光电式　光电转换器

　　３，触摸屏

三，输出设备

　　１，显示器

　　　　１，字符显示　字符发生器

　　　　２，图形显示　主管图像

　　　　３，图像显示　客观图像

　　２，打印机

　　　　１，打击式　　点阵式（逐字，逐行）

　　　　２，非打击式　激光（逐页）喷墨（逐页）

四，其他

　　１，A/D D/A　模拟/数字　转换器

　　２，终端　由键盘和显示器组成

　　　　完成显示控制与存储，键盘管理及通信控制

　　３，汉字处理　汉字输入，汉字存储，汉字输出



五，多媒体技术

　　１，生命是对媒体技术

　　２，多媒体计算机的关键技术　

###　5.3，i/o接口

一，概述

　　为什么要设置接口？

　　１，实现设备的选择

　　２，实现数据缓冲到达速递匹配

　　３，实现数据串－并格式转换

　　４，实现点平转换

　　５，传送控制命令

　　６，反映设备状态（“忙”，“就绪”，“中断请求”）

二，接口的功能和组成

　　１，总线链接范式的i/o接口电路

　　　　１，设备选择线

　　　　２，数据线

　　　　３，命令线

　　　　４，状态线

　　２，接口的功能和组成

| 功能               | 组成                   |
| ------------------ | ---------------------- |
| 选址功能           | 设备选择电路           |
| 传送命令的功能     | 命令寄存器，命令译码器 |
| 传送数据的功能     | 数据缓存寄存器         |
| 反映设备状态的功能 | 设备状态标记           |

　　　完成触发器Ｄ

　　　工作触发器Ｂ

　　　终端请求触发器INTR

　　　屏蔽触发器ＭＡＳＫ

　　　选址功能，传送命令的功能，传送

　　３，i/o接口的基本组成

　　

三，接口类型

　　１，按照数据传送方式分类

　　　　并行接口，串行接口

　　２，按功能选择的灵活性分类

　　　　可编程接口　不可编程接口

　　３，按照通用性分类

　　　　通用接口，专用接口

　　４，按数据传送的控制方式分类

　　　　中断接口，ｄｍａ接口

### 5.4，程序查询方式

一，程序查询方式的流程

　　　１，查询流程

　　　　　单个设备，　多个设备（优先级，）

　　　２，程序流程

　　　　　保存寄存器内容，设置计数器值（ｎ 或-n）设置主存缓冲区首地址

　　　３，

二，程序查询方式的接口电路

　　设备选择电路，ｘｘｘ

### 5.5，程序中断方式

一，中断的概念

　　　程序在执行程序的时候，出现特殊情况，转而需要取执行其他程序的过程

二，i/o中断的产生

　　以打印机为例

三，程序中断方式的接口电路

　　１，配置中断请求触发器和终端屏蔽触发器

　　２，排队器

　　　　排队　｜硬件　在ｃｐｕ内或在接口电路中（链式排队器）（最后那个１优先级的最高）

　　　　　　　｜软件　见第八章

　　３，中断向量地址形成部件

　　　　入口地址：｜由软件禅城　见：第八章

　　　　　　　　　｜硬件向量法　由硬件产生向量地址，再由向量地址找到入口地址

　　　　　中断向量地址形成部件（设备编码器）

　　４，程序中断方式接口电路的基本组成

　　　一共５部分：设备选择电路，ｘｘｘ

四，i/o中断处理过程

１，ｃｐｕ响应冲断的条件和时间

　　　１，条件

　　　　　允许中断触发器ＥＩＮＴ＝１

 　　　　　用开关指令将ＥＩＮＴ置　“１”

　　　　　用关中断指令将ＥＩＮＴ置“０”　或硬件自动回复

　　　２，时间

　　　　　当Ｄ＝１且mask＝０时

　　　　　在每条指令执行阶段的结束前

　　　　　ｃｐｕ发总段查询信号

２，ｉ/ｏ中断处理过程

　　出入读指令　ｃｐｕ发地址，设备选择，启动命令，设备开始工作，工作结束，输入数据　设备空闲，等待ｃｐｕ读取　进入排队器，等待，转换位地址

五，中断服务程序流程

１，总段服务程序的流程

　　１，保护现场

　　　程序端点的保护　中断隐指令完成

　　　寄存器内容的保护　进栈指令

　　２，中断服务

　　　　付不同的i/o设备具有不同内容的设备服务

　　３，恢复现场　　出栈指令

　　４，中断返回　

２，单重总断和多重总断

　　单重中断　不允许总断现行的总断服务程序

　　多重中断　允许级别更高的中断源总断现行的中断服务程序　

3，单重中断和多重中断的服务程序流程



４主程序和服务程序抢占ｃｐｕ示意图

### 5.6，ＤＭＡ方式

１．ｄｍａ和程序中断两种方式的数据通路

２，ｄｍａ和主存交换数据的三证方式

　　１，停止ｃｐｕ访问主存

　　　　控制简单

　　　　ｃｐｕ处于不工作状态或保持状态

　　　　未充分发挥ｃｐｕ对主存的利用率

　　２，周期挪用（或周期窃取）

　　　　ｄｍａ访问主存有三种可能

　　　　ｃｐｕ此时不访问

　　　　ｃｐｕ正在方寸

　　　　ｃｐｕ与ｄｍａ同事请求访存

　　　　此时ｃｐｕ将总线控制权让给ｄｍａ

　　３，ｄｍａ与ｃｐｕ交替访问

　　　　ｃｐｕ工作周期　｜ｃ１专供ｄｍａ访存

　　　　　　　　　　　　｜ｃ２专供ｃｐｕ访存

二，dma接口的功能和组成

　　１，ｄｍａ接口功能

　　　　１，向ｃｐｕ申请ｄｍａ传送

　　　　２，处理总线控制权的转交

　　　　３，管理系统总线，控制数据传送

　　　　４，确定数据传送的首地址和长度

　　　　　　修正传送过程中的数据地址和长度

　　　　５，ｄｍａ传送结束时，给出操作完成信号

　　２，ｄｍａ接口组成

## 计算机系统硬件系统





## cpu 678





## cu 9-10

