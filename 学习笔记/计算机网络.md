## 计算机网络

#### 通信模型

信源－》发送设备－》信道－》接受设备－》信宿

　　　　　　　　　　　｜

​                                      噪声源

## 交换网络



## internet网络

最大的互联网络

ｉｓｐ 网络

为网络应用提供通信服务的通信技术设施

为网络应用提供应用编程接口

## 计算接网络结构：

1. 网络边缘，

   > 主机，端系统
   >
   > 运行网络应用程序
   >
   > 客户/服务器应用模型
   >
   > 对等模型（p2p）

2. 接入应用，物质链接

   > 接入网络，
   >
   > 机构接入网络
   >
   > 移动接入网络
   >
   > dsl数字用户线路，
   >
   > hfc混合光钎同轴电缆
   >
   > 

3. 网络核心（核心网络）

   功能：路由，转发

   路由：确定分组从源到目的传输路径

   转发：将分组从路由器的输入端口交换至正确的输出端口

   #### 数据交换

   一级ｉｓｐ 向下 公司ｉｓｐ 等等

   多路复用：链路网络资源划分

   典型的多路复用方法：

   频分多路复用　电视信号

   时分多路复用　将时间分为服用帧，每个帧分成若干个时序，每个用户这在对应的时序里发送

   波分多路复用　根据每个光的波长进行分离　

   码分多路复用　广泛应用（如蜂窝网，卫星通信），每个用户分到一个马片序列

   　　　　编码信号＝原始数据×码片序列，＋１　－１　　0

   　　　　码片序列必须正交

   

   

   报文交换：发送整体信息，例子：电报

   分组交换：将报文分为一系列相对较小的数据包

   　　　　　拆分，重组，在报文头部加上一些数据，和需要拆分时间

   　　　　　统计多路复用

   两种的方式：都是存储　交换　　　　　



分组交换网络实用于突发数据传输网络

　　　　可能产生拥塞：分组延迟和丢失

　　　　协议





### 计算机性能：

速率　　　    比特

带宽　　       通常是指数字信道所能传达的最高数位

时延/延迟      分类：节点处理延迟　　　排队延迟　　传输延迟（发送总时间）　　　　传播延迟（信号传播初度）

实验带宽积＝传播延迟×带宽

　　　　　链路的试验带宽积又称尾以比特为单位的链路带宽

丢包：　队列缓存容量有限，分组达到满队列将被丢包，

　　　　丢包分组可能由前节点或源重发（也可能不重发）

　　　　丢包率：丢包数/已发分组总数

吞吐量/率：表示发送端与接受端之间传送数据速率

　　　　　即时吞吐率：给定时刻的速率

　　　　　平均吞吐率：一段时间的平均速率

#### 计算接网络的体系结构

　　　　　Ａ：分层结构　　功能层面

　　　　　　　结构清晰

　　　　　　　模块化分层易于系统更新，维护

　　　　　　　有利于标准化

　　　　　　　缺点：效率低

　　　　　基本概念：

　　　　　　　实体：表示任何可发送或接受信息的硬件或软件

　　　　　　　协议：是控制两个对等实体进行通信的规则的集合，协议是“水平的”

　　　　　　　任意层实体需要使用下层服务，遵循本层协议，实现本层功能，向上层提供服务，服务是“垂直的”

　　　　　　　下层协议的实现对上层的服务用户是透明的

　　　　　　　同系统的相邻层实体间通过借口进行交互，通过服务访问点ＳAP，交换愿语，指定请求的特定服务

#### osi参考模型

　　　七个层次

　　　主机Ａ　１－７

　　　物理层－》数据链路层－》网络层－》传输层－》会话层－》表示层－》应用层

　　　　　｜　　　　｜　　　　　｜　　　　｜　　　　｜　　　　｜　　　　｜　

　　　中间系统

　　　物理层－》数据链路层－》网络层　　　　协议

　　　　　｜　　　　｜　　　　　　｜　　　　｜　　　　｜　　　　｜　　　｜

　　　主机Ｂ

　　　物理层－》数据链路层－》网络层－》传输层－》会话层－》表示层－》应用层

　　　

　　　协议封装

　　　　加控制信息

　　　　　　地址

　　　　　　差错检测编码

　　　　　　协议控制　



　　　　物理层：

　　　　　接口特性：机械特性，电气特性，功能特性，规则特性

　　　　比特编码：

　　　　数据率：

　　　　比特同步：时钟同步

　　　　传输模式：单工，半双工，　全双工



　　　　数据链路层功能：　

　　　　节点－节点（数据传输）　

　　　　组帧：

　　　　物理地址：

　　　　　　在帧头中增加发送端和/或接收端的物理地址标识数据的发送端和/或接收端

　　　　流量控制

　　　　差错控制

　　　　访问（接入）控制



　　　　网络层功能：

　　　　负责源主机到目的主机数据分组交付

　　　　逻辑寻址：

　　　　路由：

　　　　分组转发



　　　　传输层功能：

　　　　分段重组

　　　　ＳＡＰ寻址

　　　　链接控制

　　　　流量控制

　　　　差错控制



　　　　会话层

　　　　对话控制：建立，维护

　　　　同步：

　　　　

　　　　表示层：

　　　　数据标示转化

　　　　加密/解密

　　　    压缩/解压缩



​                应用层

　　　　使用网络服务

　　　　文件传输，电子邮件，　ｗｅｂ



　#### ＴＣＰ参考模型

　　　　应用层

　　　　运输层

　　　　网际层

　　　　网络接口层



现在通用的

　　　应用层　　应用，支持各种网络应用

　　　传输层　　进程－进程的数据传输

　　　网路层　　路由转发，源主机到目的主机的数据分组路由与转发

　　　数据链路层　　相邻网络元素（主机，交换机，路由器）的数据传输

　　　物理层　　　比特传输



计算机网络的发展历史

１９６１－１９７２　早起分组交换原理的提出与应用

１９６１　排队论证实分组交换的有效性

１９６４　分组交换用于军事网络

１９６７　ａｐｐａ

１９６９：第一个ａｒｐａｎｅｔ节点运行

１９７２：ａｒｐａｎｅｔ公开演示

　　　　　第一个主机－主机协议ｎｃｐ

　　　　　第一个ｅ-ｍａｉｌ程序

　　　　　　ａｒｐａｎｅｔ拥有１５个节点



１９７２－１９８０：网络互联，大型新型，私有网络涌现

１９７０：在夏威夷构建了ａｌｏｈａｎｅｔ卫星网络

１９７４　ｃｒｅｆ　与ｋａｈｎ　提出网络互联体系结构

１９７６：ｘｅｒｏｘ　设计了以太网

７０‘ｓ 后期

１９７５：ａｐｒａｎｅｔ移交给美国国防不通信局管理

１９７９：ａｐｒａｎｅｔ拥有２００个节点



１９８０－１９９０：新型网络协议与网络的激增

１９８３：部署ｔｃｐ/ｉｐ

１９８２：定义了ｓｍｔｐ电子邮件协议

１９８３：定义了ｄｎｓ

１９８５：定义了ｆｔｐ协议

１９８８：ｔｃｐ拥塞控制

新型国家级网络　法国



１９８６；ｎｆｓ初步形成



１９９０－２０００：商业化　ｗｅｂ　新应用

１９９０’ｓ早期：ａｐｒｎｅｔ退役

１９９１：ｎｓｆ　解除限制

１９９２：因特网协会

１９９０‘ｓ后期　ｗｅｂ应用



２００５－今

　　智能手机－平板电脑

宽带接入的快速部署

无处不在的高速无线接入快速增长

出现在线社交网络

服务提供商　　　有自己专有的网络



电子商务，大学，企业等开始在“云”中运行自己的服务　（如　ａｍａｚｏｎ）







### 应用层

#### 网络应用体系机构

 客户机/服务器　　（ｗｅｂ）

纯p2p结构　优点：高度可伸缩，　缺点：复杂度高

混合结构　有文件的服务者，利用者。



#### 网络应用的基础：进程间通信

进程，同一主机上运行的进程之间如何通信

不同主机上运行的进程间如何通信

进程之间的交流：套接字：ｓｏｃｋｅｔ

进程间通信利用ｓｏｃｋｅｔ发送/接受消息实现

类似于寄信

传输基础设施向进程提供ａｐｉ



寻址：不同主机上的进程间通信，那么每个进程必须拥有标识符

端口号：每个进程有一个端口号

ｉｐ地址加端口号

应用层协议：网络应用需遵循应用协议

公开协议：由ｒｆｃ定义

　　　　　允许互操作

　　　　　ｈｔｔｐ，ｓｍｔｐ

私有协议

大胆的设计新协议



协议的内容

消息的类型

消息的语法格式

字段的语义

规则



网络应用的需求与传输层服务

数据丢失/可靠性

时间/延迟

带宽



ｉｎｔｅｒｎｅｔ提供的传输服务

　Ｔcp 服务

面向链接;

可靠的传输

流量控制

拥塞控制

不提供时间/延迟保障

不提供最小带宽保障

ＵＤＰ服务

无连接

不可靠的数据传输

不提供：等等能等等



#### web应用

　网页

　网页相互链接

网页包含多个对象

　对象

基本ｈｔｍｌ文件

对象的寻址

ｈｔｔｐ协议超文本传输协议

ｃ/s结构　客户－请求，接受，展示

无状态协议

非持久性链接，

发起请求－连接请求－确定文件位置－发送－关闭－重复

ｒｔｔ　从客户端发送一个很小的数据包到服务器

每个对象需要２个ｒｔｔ　操作系统为每个ｔｃｐ链接开销资源

建立ｔｃｐ是有代价的



持久性链接

发送响应后，服务器保持ｔｃｐ链接

后续的ｈｔｔｐ消息可以通过这个链接发送

等等



ｈｔｔｐ消息格式

请求消息：方法，ｕｒｌ　名字，东西

ａｓｃｉｉ：　人直接可读



响应消息

上次的修改时间，

状态码　　４０４



　

cookie技术

有存储功能

增加一个可扩展标记号

功能：身份认证，购物车，推荐，ｗｅｂ　ｅ-ｍａｉｌ

问题：隐私问题



ｗｅｂ缓存/代理服务器技术

功能：不访问服务器的前提下满足客户端的ｈｔｔｐ请求

优点：缩短客户请求时间，减少机构/组织的流量，在大范围内实现有效的内容分发

时间：建立一个代理服务器，里客户端近的

问题：版本是最新的吗？

条件性ｇｅｔ方法

目标：如果缓存有最新的版本，则不需要发送请求对象

缓存：在ｈｔｔｐ请求消息中声明所持有版本的日期

服务器：如果缓存的版本是最新的，则响应消息中不包含对象



#### Email应用

邮件服务器

邮箱：存储发给该用户

消息队列：存储等待发送的ｅmail

ｓｍｔｐ　邮件服务器之间的消息传递所使用的协议

使用ｔｃｐ协议　



命令的响应模式

持久性链接

要求小时必须是７尾ａｓｃｉｉ码构成

ｓｍｔｐ服务器



ｅｍａｉｌ消息的格式　传输/交换协议

ｒｆｃ８２２：文本消息格式标准

头部行：　

消息体：



多媒体扩展：

ｍｉｍｅ通过在邮件头部增加额外的行以生命ｍｉｍｅ的内容类型

邮件访问协议：从服务器获取邮件　ｐｏｐ　ｉｍａｐ　ｈｔｔｐ等

ｐｏｐ协议

认证过程　客户端命令，服务器响应，事物阶段　ｌｉｓｔ　ｒｅｔｒ　ｄｅｌｅ

ｑｕｉｔ

下载并删除　模式

下载并保持　模式

ｐｏｐ３是无状态协议

ｉｍａｐ　所有消息保存在一个地方：服务器

允许用户利用文件夹组织消息

ｉｍａｐ支持快回话的用户状态



####　dns概述

域名系统

解决的是互联网上的主机/路由器的识别问题

问题：域名和ｉｐ地址之间如何映射

域名解析系统ｄｎｓ　

​     多层命名服务器构成的分布式数据库

　　应用层协议：完成名字的解析

ｄｎｓ：域名向ｉｐ地址等待翻译

　　　　主机别名

　　　　邮件服务器别名

　　　　负载均衡：ｗｅｂ服务器

问题：为什么不使用集中式的ｄｎｓ

　　　　单点失败问题，流量问题，距离问题，维护性问题

　　　结构：

分布式层次式数据库：代价查询次数

本地访问根域名服务器－再到权威域名服务器

顶级域名服务器　负责ｃｏｍ　，ｏｒｇ，ｎｅｔ，

权威域名服务器（学校等）

本地域名解析服务器



本地域名服务器缓存与更新



ｄｎｓ记录和消息格式

资源记录

ｔｙｐｅ＝Ａ　主机域名：ｉｐ地址

ｔｙｐｅ＝ＮＳ　域　该域权威域名解析服务的主机域名

ｔｙｐｅ＝ｃｎａｍｅ　某一真实域名的别名　真实域名

ｔｙｐｅ－ｍｘ 与ｎａｍｅ相对应的邮件服务器



ｄｎｓ协议与消息

ｄｎｓ协议查询和回复　消息

消息格式

消息头部



如何注册域名：

域名管理机构注册域名

向域名管理机构提供你的权威域名解析服务器的名字和ｉｐ地址

域名管理机构向ｃｏｍ顶级域名解析服务中插入两条记录

在权威域名接续服务器中为ｘｘｘｘｘｘ



#### p2p应用：

文件分发：

客户机/服务器ｖｓ。p2p

服务器串行地发送ｎ个副本　　ｎｆ/u

客户机ｉ需要ｆｄ时间下载

p2p

服务器必须发送一个副本f/u

客户机ｉ需要ｆ/d时间下载

总共需要下载ｎｆ比特

最快的可能上传速率　ｕ＋和ｕ



bt协议

动态的加入与离开



p2p索引技术：

文件技术电驴，即时消息ｑｑ



集中式索引

单点失效问题，性能瓶颈，版权问题。

分布式索引（洪泛式查询）

完全分布式架构，

每个节点进行索引

覆盖网络

查询消息通过已有的ｔｃｐ链接发送，

节点转发查询消息，

如果查询命中，则利用反向路径发回查询节点



层次是覆盖网络

介于集中式索引和洪泛式之间的查询

每个节点被分配一个超级节点





###　套接字编程

应用层到传输层

应用进程控制|

ａｐｉ

操作系统控制|



最初的设计　面向ｔｃｐ/ｉｐ协议栈接口

目前

大部分系统都支持

ｉｎｔｅｒｎｅｔ

通信模型

应用进程之间通信的抽象机制

不同进程之间的区分，创建端口号

对外：ｉｐ地址＋端口号

操作系统如何管理（对内）

套接字管理

ｕｎｉｘ　类似于文件的抽象、

当应用进程创建套接字时，操作系统分配一个数据结构存储该套接字相关信息

返回套接字描述符

已定义结构ｓｏｃｋａｄｄｒ_ｉｎ

有地址长度，地址族，端口号，ｉｐ地址，未用



函数ｓｏｃｋｅｔ创建套接字

操作系统返回套接字描述符

第一个参数（协议族）

第二个参数（套接字类型）

第三个参数（协议号）：默认为０

ｔｃｐ：可靠，面向链接，字节流传输，点对点

ｕｄｐ：不可靠，无连接，数据包传输



ｃｌｏｓｅｓｏｃｋｅｔ

关闭一个描述符ｓｄ的套接字

如果多个进程共享一个套接字，调用ｃｌｏｓｅｓｏｃｋｅｔ将套接字引用次数减一，减至０才关闭

一个进程中的多现场呢过对一个套接字使用无计数

返回值　０　成功



ｂｉｎｄ　绑定套接字本地端点地址

ｉｐ＋端口号

参数

客户程序一班不必调用ｂｉｎｄ函数



服务器应该绑定那个地址

解决方案，地址通配符



ｌｉｓｔｅｎ

置服务器端的套接字处于监听状态

仅用于服务器端的调用

仅用于面向链接的流套接字

设置连接请求队列大小

返回值　０　或者失败



ｃｏｎｎｅｃｔ　

客户端调用ｃｏｎｎｅｃｔ来使用客户端套接字ｓｄ与特定计算机的特定端口的套接字进行链接

仅用于客户端



ａｃｃｅｐｔ

创建新的套接字与客户通信

ｓｅｎｄ　ｓｅｎｄｔｏ　发送函数

ｒｅｃｖ，ｒｅｃｖｆｒｏｍ接受函数

ｓｅｔｓｏｃｋｅｔ，ｇｅｔｓｏｃｋｅｔ函数设置套接字选项的参数



关于网络字节顺序

ｔｃｐ/ip定义了标准二进制整数表示



解析服务器ｉｐ地址

　　函数ｉｎｅｔ_ａｄｄｒ（）

　　函数ｇｅｔｈｏｓｔｂｙｎａｍｅ（）实现域名到实名３２位ｉｐ地址转换

解析服务端口号

客户端海可能使用服务名表示服务器端口

将服务名转换位数知的端口号

函数ｇｅｔｓｅｒｖｂｙｎａｍｅ

解析协议号

ｔｃｐ客户端软件流程

１确定服务器ｉｐ地址与端口号

２创建套接字

３分配本地端点地址

４链接服务器

５遵循应用层协议进行通信６

６关闭或者释放





服务器设计

４种基本的服务器

循环无连接服务器基本流程

１穿件套接字

２绑定端点地址

３反复接受来自客户端的请求

４遵循应层的协议，构造响应报文，发送给客户

数据发送

不能服务器使用ｃｏｎｎｅｃｔ函数

无连服务器使用ｓｅｎｄｔｏ函数发送数据包

调用ｒｅｃｖｆｒｏｍ　函数接受数据是，自动提取



循环面向连接服务器基本流程

１创建住套接字，绑定端口号

２设置套接字尾被动监听模式，准备用于服务器

３调用ａｃｃｅｐｔ函数接受下一个连接请求　创建新套接字用于与该客户建立链接

４尊新应用层协议，反复接受客户请求，构造并发送响应

５完成尾特定客户端服务后，关闭与该客户之间的链接，



并发无连接服务器基本流程

主线程１

主线程２



子线程１

子线程２



并发面向连接服务器基本流程



### 传输层

多路复用/分用

可靠数据传输机制

流量控制机制

拥塞控制机制

Ｉｎｔｅｒｎｅｔ的传输层协议

ｕｄｐ：无连接的传输层协议

ｔｃｐ：面向链接的传输服务

ｔｃｐ：拥塞控制



####　宏观

传输层协议为运行在不同ｈｏｓｔ上的进程提供了一种逻辑通信机制

端系统运行传输层协议

发送方，接受方

传输层可以为应用提供多种协议

传输层ｖｓ网络层

网络层提供主机之间的逻辑通信截止，

传输层：提供应用进程之间的逻辑通信机制

ｉｎｔｅｒｎｅｔ传输层协议

可靠的，按序的交付服务ｔｃｐ

　　拥塞控制，流量控制，链接建立

不可靠的交付服务ｕｄｐ

给予尽力而为　的网络层，没有可靠方面性的扩展

都不提供：延迟，带宽　服务





多路复用/分用

分用：主机接受到ｉｐ数据报，主机收到ｓｅｇｍｅｎｔ之后，传输层协议提取ｉｐ地址胡端口信息，将ｓｅｇｍｅｎｔ导向响应的ｓｏｃｋｅｔ７

无连接分用：利用端口号创建ｓｏｃｋｅｔ，

ｕｄｐ的ｓｏｃｋｅｔ用二院标示，

主机收到ｕｄｐ段后

来自不同源ｉｐ地址和/或源端口号的ｉｐ数据包被导向同一个ｓｏｃｋｅｔ



ｕｄｐ给予ｉｎｔｅｒｎｅｔｉｐ协议

服用/分用

错误校验

ｂｅｓｔ　ｅｆｆｏｒｔ　服务

丢失

非按序到达

无连接

不需要握手

单独处理每个段



价值：不需要建立链接　（减少延迟）

实现简单，

头部开销少

没有拥塞控制：



用途：流媒体　容忍丢失，速率敏感

ｕｄｐ实现可靠数据传输

在应用层增加可好数据传输？

发送方：计算校验和１６位

接受方：接受到段的校验和进行比较

进位的最高位被加到地位上



####　可靠的数据传输原理

不错，不丢，不乱，

传输层向上层提供一个可靠的信道

可靠的数据传输协议

ｒｄｔ１．０

底层信道完全可靠

发送方和接受方的fsm独立

发送方就发送，接受方，就接受

ｒｄｔ２．０

底层会产生位错误的信道

如可恢复

确认机制：接受方显示的告诉发送方分组已经正确接受

ｎａｋ：接受方显示地告知发送方分组错误

发送方重新发送

新机制：差错检测，反馈信息，重新发送

实现：发送方：发送，等待反馈，重新发送或不重发　等待反馈

　　　接受方：等待下层，判断，有错，返回ｎａｋ，没有错误，返回ａｃｋ，传到上层

ｒｄｔ２．１和２．２

ｒｄｔ２．０ 问题：反馈消息发生错误

方案１．增加校验，纠错

方案２.添加额外的控制消息

方案３．重发

解决：序列号：发送每个分组增加序列号

接受方丢弃重复分组

２．１增加序列号

２．２取消ａｃｋ，ｎａｋ，校验序列号



ｒｄｔ３．０

可能丢失分组或者发生错误

等待合理时间：没有ａｃｋ重传，如果延迟，

定时器

功能正确，但是性能很差

网络协议有可能限制了硬件的利用

流水线设置

更大范围的序列号

发送方和/或者接受方需要更大的存储空间以缓存分组

滑动窗口协议

窗口：允许使用的序列号范围

　　窗口尺寸尾Ｎ:最多有Ｎ个等待确认的消息

滑动窗口协议

随着协议的运行：窗口在序列号空间向前滑动

协议：ｇｂｎ　ｓｒ



流水线机制：提高资源利用率

流水线协议

发出去确认的，发出去没有确认的，下一个可以用的，不能用的

ｇ-back-n协议

分组头部包含ｋ-bit 序列号

串口尺寸为ｎ,最多允许n个分组未确认

ａｃｋ：确认到序列号为n的分组均已被正确接收

为空中的分组设置计时器

超市时间：重传系列号大于等于ｎ,还没有收到ａｃｋ的所有分组

确认拥有最高序列号，已被正确接受的分组ａｋｄ，乱序就丢弃

后退ｎ帧，看最大确定帧，例题里３被确认了，说明１的　确认　丢失了

饭４５６７就行



ｇｂｎ缺陷，后退ｎ帧有浪费

ｓｒ多了一个接收的缓存窗口，只发送没有接受的分组，乱序缓存

ｓｒ困境　可用序列号比较少



#### tcp协议

点对点

可靠，按需的字节流

流水线机制

发送方/接受方缓存

全双工

面向链接

流量控制





段结构：

序列号：建立的时候是随机的

ａｃｋ：累计确认：该序列号之前的所有字节均以被正确接收到

ｑ：如何处理乱序到达的ｓｅｇｍｅｎｔ

Ａ：ｔｃｐ规范中没有规定，有ｔｃｐ的实现着做出决策



ｔｃｐ的可靠数据传输：

ｔｃｐ在ｉｐ层的不可靠服务基础上实现可靠数据传输

流水线机制

累计确认

ｔｃｐ使用单一重传定时器

触发重传的事件

渐进式



ｒｔｔ和超时

定时器事件确定问题

大于ｒｔｔ但是ｒｔｔ是变化的

过短，不必要的重传，过长丢失时间反应慢

问题：如何估计ｒｔｔ，ｓａｍｐｌｅｒｔｔ测量从段发出去到收到ａｃｋ的事件

ｒｔｔ辩护求平均值形成ｒｔｔ估计

安全边界：

ｓａｍｒｔｔ与ｅｓｔｒｔｔ的差值

ｄｅｖｒｔｔ

定时器超时时间设置



ｔｃｐ发送方事件

从应用层收到数据

创建ｓｅｇｍｅｎｔ　序列号是ｓｅｇｍｅｎｔ第一个字节编号

开启计时器，设置超时时间，

超时：重传超时的一个

收到ａｃｋ，如果确认此前从未确认的ｓｅｇｍｅｎｔ更行ｓｅｎｄｂａｓｅ



快速重传机制：

ｔｃｐ实现中，如果发生超时，超时时间间隔将重新设置，即将超时事件间隔加倍

导致其很大

ｔｃｐ流量控制：

接收方为ｔｃｐ链接分配ｂｕｆｆｅｒ

上层应用可能处理ｂｕｆｆｅｒ中数据的速度较慢。



ｔｃｐ的链接管理

链接的发起者是等待客户去请求

三次握手，

客户端ｓｙｎ建立连接

服务器ｓｙｎａｃｋ报文

客户机答复一个ａｃｋ报文段



ｔｃｐ链接管理关闭：四次握手

客户发送ｆｉｎ，

服务器回复ａｃｋ，关闭连接，发送ｆｉｎ

客户收到ｆｉｎ回复ａｃｋ，进入等待如果收到ｆｉｎ重新发送ａｃｋ

服务器收到ａｃｋ，链接关闭



拥塞控制：

分足丢失（路由器缓存溢出）

分组延迟过大（在路由器缓存中带队）

拥塞控制（网络）　ｖｓ流量控制（双方）

吞吐率：　一阶线性，

时延：快速增大

代价：上游的处理处理被浪费掉了



管制网络发送方发送的数据

端到端的控制

网络辅助的拥塞控制

路由器向发送发送反馈网络拥塞信息

指示发送发应该采取何种速率



ａｂｒ网络辅助：负载低尽量用，负载高发的低，

ｒｍ发送发发送，交换机设置ｒｍｃｅｌｌ位，ｒｍｃｅｌｌ由接收方返回给发送方

数据ｃｅｌｌ，资源管理ｃｅｌｌ，有拥塞和速率　



ｔｃｐ拥塞控制基本原理

如何感知网络拥塞

加性增乘性减：

原理：慢慢加，过大的时候，处于２

慢启动：ｓｓ

原理，当链接开始时，指数性增长，

实现方法：

ｌｏｓｓ事件：

３个重复的ａｃｋ，剪切到一半，ｔｉｍｅｏｕｔ事件：直接设位１ｍｓｓ

然后指数增长，达到ｔｈｒｅｓｈｏｌｄ后再线性增长

ｔｉｍｅｏｕｔ到时是从一开始１，三个ａｃｋ是减为一半

ｃｏｎｇｗｉｎ　

ｔｈｒｅｓｈｏｌｄ变成２分之一窗口



吞吐率　

ｗ/rtt

公平性



### 网络层

转发，转发表（广义地址），

路由　路由协议，路由算法

链接的建立，链路重的每一个都需要链接

网络层：主机到主机，（路径上的路由器等网络设备参与其中）

传输层　：两个应用进程之间（对中间网络设备透明）



ｉｎｔｅｒｎｅｔ尽力服务

很多保证没有，

ａｔｍ网络

网络有不同的服务模型很多大概分为

无连接的模型

有链接的模型

有链接的网络







